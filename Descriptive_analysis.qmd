---
title: "Explonatory Analysis of a Crime Data"
format: html
editor: visual
---

```{r,include=FALSE}
library(tidyverse)
```

## Data Set

Here is the link of the data we used for our analysis: https://data.lacity.org/Public-Safety/Crime-Data-from-2020-to-Present/2nrs-mtv8

## Data set Description

This dataset reflects incidents of crime in the City of Los Angeles dating back to 2020. There are 521k rows (each row is a crime incident) and 28 columns (Variables).

1.  *DR_NO* - Division of records number: Official file number made up of a 2 digit year, area ID, and 5 digits.

2.  *Date Rptd* - Reported date of the crime

3.  *Date OCC* - Occured date of the crime

4.  *TIME OCC* - occured time of the crime in 24 hour military time.

5.  *AREA* - The Los Angeles Police Department has 21 community police Stations referred to as Geographic Areas within the department. These Geographic Areas are sequentially numbered from 1-21.

6.  *AREA NAME* - Name designation of the area.

7.  *Rpt Dist No* - A four digit code that represents a sub area with a geographic Area.

8.  *Part 1-2* - no discription

9.  *Crm cd* - indicates the crime committed (same as the *Crm cd 1*)

10. *Crm cd Desc* - Defines the crime Code Provided.

11. *Mocodes* - Activities associated with the suspect in commission of the crime.

12. *Vict Age* - Age of the Victim.

13. *Vict Sex* - Sex of the Victim (*F* - Female/ *M* - Male, *X*- Unknown)

14. *Vict Descent* - Descent Code of the Victim (*A*-other Asian, *B*-Black, *C*-Chinese, etc.)

15. *Premis Cd* - The type of structure, vehicle, or location where the crime took place.

16. *Premis Desc* Defines the Premis Cd provided.

17. *Weapon Used Cd* The type of weapon used in crime given as a code.

18. *Weapon Desc* Defines the code of the weapon used in crime.

19. *Status* Provides the status of the case in code.

20. *Status Desc* Description of the status code provided.

21. *Crm Cd 1* It indicates the crime committed where Crime Code 1 represents the most serious crime.

22. *Crm Cd 2* It also indicates the crime code but it is less serious than Crm Cd 1.

23. *Crm Cd 3* This crime code is for less serious crime than represented by Crm Cd 1 and Crm Cd 2.

24. *Crm Cd 4* This crime code is for the least serious crime.

25. *LOCATION* Street address of crime incident rounded to nearest hundred blocks.

26. *Cross Street* Cross street of the rounded address.

27. *LAT* Latitude.

28. *LON* Longitude.

### Loading data

```{r}
data<-read.csv("Subset_data.csv")
```

### Method

For the convenience of the analysis the variable (`Crm.Cd.Desc`) representing the type of crimes were coded into general categories. The re-categorization was like if the crime contained the word Assualt then crime was categorized as `ASSUALT`, if the crime contained the word Burglary or Stolen or Theft then the crime was coded as `BURGLARY`, if the crime contained the word Criminal or Weapon or Shots or Threat or Kidnap then the crime was coded as `Extreme crimes`, if the crime contained the word Sex or Rape then the crime was coded as `SEXUAL MISCONDUCT`, some crimes were coded as their names like Violation,Robbery, and Trespassing, and rest of the crimes are coded as `OTHER CRIMES`. The missing values of variable `Vict.Sex` was coded as unknown. For some of the crimes that was coded the frequently occurred (More than 3%) premises in the data were presented.

#### Codes for recoding

```{r}
for(i in 1:length(data$Crm.Cd.Desc)){
if(str_detect(data$Crm.Cd.Desc[i],"ASSAULT")==TRUE & 
   str_detect(data$Crm.Cd.Desc[i],"SEXUAL")!=TRUE){
  data$crime[i]<-"ASSAULT"
} else if(str_detect(data$Crm.Cd.Desc[i],"VIOLATION")==TRUE){
  data$crime[i]<-"VIOLATION"
}  else if(str_detect(data$Crm.Cd.Desc[i],"BURGLARY")==TRUE|
           str_detect(data$Crm.Cd.Desc[i],"STOLEN")==TRUE|
            str_detect(data$Crm.Cd.Desc[i],"THEFT")==TRUE){
  data$crime[i]<-"BURGLARY"
} else if(str_detect(data$Crm.Cd.Desc[i],"SEX")==TRUE|str_detect(data$Crm.Cd.Desc[i],"RAPE")==TRUE){
  data$crime[i]<-"SEXUAL MISCONDUCT"
} else if(str_detect(data$Crm.Cd.Desc[i],"VANDALISM")==TRUE){
  data$crime[i]<-"VANDALISM"
} else if(str_detect(data$Crm.Cd.Desc[i],"CRIMINAL")==TRUE|
          str_detect(data$Crm.Cd.Desc[i],"WEAPON")==TRUE|
          str_detect(data$Crm.Cd.Desc[i],"SHOTS")==TRUE|
          str_detect(data$Crm.Cd.Desc[i],"THREAT")==TRUE|
          str_detect(data$Crm.Cd.Desc[i],"KIDNAP")==TRUE){
  data$crime[i]<-"EXTREME CRIMES"
} else if(str_detect(data$Crm.Cd.Desc[i],"ROBBERY")==TRUE){
  data$crime[i]<-"ROBBERY"
} else if(str_detect(data$Crm.Cd.Desc[i],"TRESPASSING")==TRUE){
  data$crime[i]<-"TRESPASSING"
}else data$crime[i]<-"OTHER CRIMES"
}

data$Sex<-ifelse(data$Vict.Sex=="M","Male",ifelse(data$Vict.Sex=="F","Female","Unknown"))
```

### Analysis


Now we will be exploring which sex group is experiencing which type of crime more or less. To explore that we are filling the occurrence of crimes with respect to the sex of the victim.

```{r}
data %>%
  group_by(crime,Sex) %>% 
  count() %>% 
  ungroup() %>% 
      ggplot()+
        aes(x=reorder(crime,n),y=n,fill=Sex)+
        geom_col(position = "dodge")+
        coord_flip()+
          scale_fill_manual(values = c("#AE4371", "lightblue", "lightyellow"))+
          labs(x="List of Crimes",title="Visual representation of which Sex group is victim of which crime")+
          theme_bw()
```

The graph gives us a view that burglary, assault, vandalism, robbery and extreme crimes are happening with the males more compared to females and people with un-identified sex in the data. The graph also demonstrates that females are more victim of crime like violation and sexual misconduct compared to males. It is also interesting to report that the crimes other than the specified ones are occurring both equally with males and females.


Now we will move to explore the premises of different crimes we defined for the convenience of our analysis. We are reporting the premises which appeared more than 3% of the times for the crimes.

```{r}
knitr::kable(data %>% 
  filter(crime=="BURGLARY") %>% 
  count(Premis.Desc) %>% 
  mutate(prop=prop.table(n)) %>% 
  filter(prop>0.030) %>% 
  select(Premis.Desc) %>% 
    rename("Premis of Burglary"="Premis.Desc"))
```
We observe that driveway, garage, multi-unit or single family dwelling, street, parking lot are the frequently occurred premises for the crime burglary. 


```{r}
knitr::kable(data %>% 
  filter(crime=="ASSAULT") %>% 
  count(Premis.Desc) %>% 
  mutate(prop=prop.table(n)) %>% 
  filter(prop>=0.03) %>% 
  select(Premis.Desc) %>% 
    rename("Premis of Assault"="Premis.Desc"))
```

We also observe that assault are being reported frequently taking place in street, sidewalk, parking lot, and single family or multi-unit dwelling.

```{r}
knitr::kable(data %>% 
  filter(crime=="SEXUAL MISCONDUCT") %>% 
  count(Premis.Desc) %>% 
  mutate(prop=prop.table(n)) %>% 
  filter(prop>=0.03) %>% 
  select(Premis.Desc) %>% 
    rename("Premis of Sexual Misconduct"="Premis.Desc"))
```

The frequent premises of sexual misconduct is similar to the premises that were reported for burglary and assault but the interesting is that we found that police facility is a frequently occurred premise for the crime sexual misconduct.


```{r}
knitr::kable(data %>% 
  filter(crime=="EXTREME CRIMES") %>% 
  count(Premis.Desc) %>% 
  mutate(prop=prop.table(n)) %>% 
  filter(prop>=0.03) %>% 
  select(Premis.Desc) %>% 
    rename("Premis of Extreme Crimes"="Premis.Desc"))
```

As expected from the frequently occurred premises of previous crimes, the extreme crimes are also frequently happening in the street, parking lot, sidewalk, and dwelling's. But here alley is a new premise we observed in case of extreme crimes.

### Boxplot of Age distribution for each crime in the dataset

```{r}
ggplot(data=data)+
  aes(x=crime,y=Vict.Age)+
  geom_boxplot()+
  labs(x="List of crimes",
        y="Age",title ="Age variation according to the list of crimes")+
  coord_flip()
```

